<!-- Budget Table Component -->
<div class="budget-table-wrapper">
    <div class="table-responsive">
        <table class="table table-hover budget-table" id="budget-table">
            <thead class="table-light">
                <tr>
                    <th scope="col">
                        <div class="d-flex align-items-center">
                            Budget ID
                            <i class="icon-chevron-up ms-1 text-muted sort-icon"></i>
                        </div>
                    </th>
                    <th scope="col">
                        <div class="d-flex align-items-center">
                            Category
                            <i class="icon-chevron-up ms-1 text-muted sort-icon"></i>
                        </div>
                    </th>
                    <th scope="col">
                        <div class="d-flex align-items-center">
                            Period
                            <i class="icon-chevron-up ms-1 text-muted sort-icon"></i>
                        </div>
                    </th>
                    <th scope="col">
                        <div class="d-flex align-items-center">
                            Allocated
                            <i class="icon-chevron-up ms-1 text-muted sort-icon"></i>
                        </div>
                    </th>
                    <th scope="col">
                        <div class="d-flex align-items-center">
                            Used
                            <i class="icon-chevron-up ms-1 text-muted sort-icon"></i>
                        </div>
                    </th>
                    <th scope="col">
                        <div class="d-flex align-items-center">
                            Remaining
                            <i class="icon-chevron-up ms-1 text-muted sort-icon"></i>
                        </div>
                    </th>
                    <th scope="col">Status</th>
                    <th scope="col">Owner</th>
                    <th scope="col" class="text-center">Actions</th>
                </tr>
            </thead>
            <tbody>
                <tr class="budget-row" data-budget-id="BDG-2024-001">
                    <td>
                        <div class="budget-id">
                            <strong>BDG-2024-001</strong>
                            <br><small class="text-muted">Product Marketing</small>
                        </div>
                    </td>
                    <td>
                        <span class="category-badge badge bg-primary">Marketing</span>
                    </td>
                    <td>
                        <div class="period-info">
                            <strong>Q1 2024</strong>
                            <br><small class="text-muted">Jan - Mar</small>
                        </div>
                    </td>
                    <td>
                        <div class="amount-info">
                            <strong class="text-primary">$450,000</strong>
                        </div>
                    </td>
                    <td>
                        <div class="amount-info">
                            <strong class="text-success">$387,500</strong>
                            <br><small class="text-muted">86.1%</small>
                        </div>
                    </td>
                    <td>
                        <div class="amount-info">
                            <strong class="text-info">$62,500</strong>
                            <br><small class="text-muted">13.9%</small>
                        </div>
                    </td>
                    <td>
                        <span class="status-badge badge bg-success">
                            <i class="icon-check-circle me-1"></i>Active
                        </span>
                    </td>
                    <td>
                        <div class="owner-info">
                            <div class="owner-avatar">JM</div>
                            <div class="owner-details">
                                <strong>Jane Manager</strong>
                                <br><small class="text-muted">Marketing Lead</small>
                            </div>
                        </div>
                    </td>
                    <td class="text-center">
                        <div class="action-buttons">
                            <button class="btn btn-sm btn-outline-primary" onclick="budgetManagement.details('BDG-2024-001')" title="View Details">
                                <i class="icon-eye"></i>
                            </button>
                            <button class="btn btn-sm btn-outline-secondary" onclick="budgetManagement.edit('BDG-2024-001')" title="Edit Budget">
                                <i class="icon-edit"></i>
                            </button>
                            <div class="dropdown d-inline">
                                <button class="btn btn-sm btn-outline-secondary dropdown-toggle" data-bs-toggle="dropdown">
                                    <i class="icon-more-vertical"></i>
                                </button>
                                <ul class="dropdown-menu">
                                    <li><a class="dropdown-item" href="#" onclick="duplicateBudget('BDG-2024-001')">
                                        <i class="icon-copy me-2"></i>Duplicate
                                    </a></li>
                                    <li><a class="dropdown-item" href="#" onclick="exportBudget('BDG-2024-001')">
                                        <i class="icon-download me-2"></i>Export
                                    </a></li>
                                    <li><hr class="dropdown-divider"></li>
                                    <li><a class="dropdown-item text-danger" href="#" onclick="budgetManagement.delete('BDG-2024-001')">
                                        <i class="icon-trash me-2"></i>Delete
                                    </a></li>
                                </ul>
                            </div>
                        </div>
                    </td>
                </tr>

                <tr class="budget-row" data-budget-id="BDG-2024-002">
                    <td>
                        <div class="budget-id">
                            <strong>BDG-2024-002</strong>
                            <br><small class="text-muted">Sales Operations</small>
                        </div>
                    </td>
                    <td>
                        <span class="category-badge badge bg-success">Operations</span>
                    </td>
                    <td>
                        <div class="period-info">
                            <strong>Q1 2024</strong>
                            <br><small class="text-muted">Jan - Mar</small>
                        </div>
                    </td>
                    <td>
                        <div class="amount-info">
                            <strong class="text-primary">$325,000</strong>
                        </div>
                    </td>
                    <td>
                        <div class="amount-info">
                            <strong class="text-warning">$298,750</strong>
                            <br><small class="text-muted">91.9%</small>
                        </div>
                    </td>
                    <td>
                        <div class="amount-info">
                            <strong class="text-info">$26,250</strong>
                            <br><small class="text-muted">8.1%</small>
                        </div>
                    </td>
                    <td>
                        <span class="status-badge badge bg-warning">
                            <i class="icon-clock me-1"></i>Review
                        </span>
                    </td>
                    <td>
                        <div class="owner-info">
                            <div class="owner-avatar">BS</div>
                            <div class="owner-details">
                                <strong>Bob Supply</strong>
                                <br><small class="text-muted">Operations Manager</small>
                            </div>
                        </div>
                    </td>
                    <td class="text-center">
                        <div class="action-buttons">
                            <button class="btn btn-sm btn-outline-primary" onclick="budgetManagement.details('BDG-2024-002')" title="View Details">
                                <i class="icon-eye"></i>
                            </button>
                            <button class="btn btn-sm btn-outline-secondary" onclick="budgetManagement.edit('BDG-2024-002')" title="Edit Budget">
                                <i class="icon-edit"></i>
                            </button>
                            <div class="dropdown d-inline">
                                <button class="btn btn-sm btn-outline-secondary dropdown-toggle" data-bs-toggle="dropdown">
                                    <i class="icon-more-vertical"></i>
                                </button>
                                <ul class="dropdown-menu">
                                    <li><a class="dropdown-item" href="#" onclick="duplicateBudget('BDG-2024-002')">
                                        <i class="icon-copy me-2"></i>Duplicate
                                    </a></li>
                                    <li><a class="dropdown-item" href="#" onclick="exportBudget('BDG-2024-002')">
                                        <i class="icon-download me-2"></i>Export
                                    </a></li>
                                    <li><hr class="dropdown-divider"></li>
                                    <li><a class="dropdown-item text-danger" href="#" onclick="budgetManagement.delete('BDG-2024-002')">
                                        <i class="icon-trash me-2"></i>Delete
                                    </a></li>
                                </ul>
                            </div>
                        </div>
                    </td>
                </tr>

                <tr class="budget-row" data-budget-id="BDG-2024-003">
                    <td>
                        <div class="budget-id">
                            <strong>BDG-2024-003</strong>
                            <br><small class="text-muted">Customer Acquisition</small>
                        </div>
                    </td>
                    <td>
                        <span class="category-badge badge bg-info">Acquisition</span>
                    </td>
                    <td>
                        <div class="period-info">
                            <strong>Q2 2024</strong>
                            <br><small class="text-muted">Apr - Jun</small>
                        </div>
                    </td>
                    <td>
                        <div class="amount-info">
                            <strong class="text-primary">$275,000</strong>
                        </div>
                    </td>
                    <td>
                        <div class="amount-info">
                            <strong class="text-success">$89,500</strong>
                            <br><small class="text-muted">32.5%</small>
                        </div>
                    </td>
                    <td>
                        <div class="amount-info">
                            <strong class="text-info">$185,500</strong>
                            <br><small class="text-muted">67.5%</small>
                        </div>
                    </td>
                    <td>
                        <span class="status-badge badge bg-success">
                            <i class="icon-check-circle me-1"></i>Active
                        </span>
                    </td>
                    <td>
                        <div class="owner-info">
                            <div class="owner-avatar">JS</div>
                            <div class="owner-details">
                                <strong>John Salesman</strong>
                                <br><small class="text-muted">Sales Lead</small>
                            </div>
                        </div>
                    </td>
                    <td class="text-center">
                        <div class="action-buttons">
                            <button class="btn btn-sm btn-outline-primary" onclick="budgetManagement.details('BDG-2024-003')" title="View Details">
                                <i class="icon-eye"></i>
                            </button>
                            <button class="btn btn-sm btn-outline-secondary" onclick="budgetManagement.edit('BDG-2024-003')" title="Edit Budget">
                                <i class="icon-edit"></i>
                            </button>
                            <div class="dropdown d-inline">
                                <button class="btn btn-sm btn-outline-secondary dropdown-toggle" data-bs-toggle="dropdown">
                                    <i class="icon-more-vertical"></i>
                                </button>
                                <ul class="dropdown-menu">
                                    <li><a class="dropdown-item" href="#" onclick="duplicateBudget('BDG-2024-003')">
                                        <i class="icon-copy me-2"></i>Duplicate
                                    </a></li>
                                    <li><a class="dropdown-item" href="#" onclick="exportBudget('BDG-2024-003')">
                                        <i class="icon-download me-2"></i>Export
                                    </a></li>
                                    <li><hr class="dropdown-divider"></li>
                                    <li><a class="dropdown-item text-danger" href="#" onclick="budgetManagement.delete('BDG-2024-003')">
                                        <i class="icon-trash me-2"></i>Delete
                                    </a></li>
                                </ul>
                            </div>
                        </div>
                    </td>
                </tr>

                <tr class="budget-row" data-budget-id="BDG-2024-004">
                    <td>
                        <div class="budget-id">
                            <strong>BDG-2024-004</strong>
                            <br><small class="text-muted">Territory Development</small>
                        </div>
                    </td>
                    <td>
                        <span class="category-badge badge bg-warning">Development</span>
                    </td>
                    <td>
                        <div class="period-info">
                            <strong>Q3 2024</strong>
                            <br><small class="text-muted">Jul - Sep</small>
                        </div>
                    </td>
                    <td>
                        <div class="amount-info">
                            <strong class="text-primary">$180,000</strong>
                        </div>
                    </td>
                    <td>
                        <div class="amount-info">
                            <strong class="text-danger">$195,000</strong>
                            <br><small class="text-muted">108.3%</small>
                        </div>
                    </td>
                    <td>
                        <div class="amount-info">
                            <strong class="text-danger">-$15,000</strong>
                            <br><small class="text-muted">Over budget</small>
                        </div>
                    </td>
                    <td>
                        <span class="status-badge badge bg-danger">
                            <i class="icon-alert-triangle me-1"></i>Over Budget
                        </span>
                    </td>
                    <td>
                        <div class="owner-info">
                            <div class="owner-avatar">SA</div>
                            <div class="owner-details">
                                <strong>System Admin</strong>
                                <br><small class="text-muted">Administrator</small>
                            </div>
                        </div>
                    </td>
                    <td class="text-center">
                        <div class="action-buttons">
                            <button class="btn btn-sm btn-outline-primary" onclick="budgetManagement.details('BDG-2024-004')" title="View Details">
                                <i class="icon-eye"></i>
                            </button>
                            <button class="btn btn-sm btn-outline-secondary" onclick="budgetManagement.edit('BDG-2024-004')" title="Edit Budget">
                                <i class="icon-edit"></i>
                            </button>
                            <div class="dropdown d-inline">
                                <button class="btn btn-sm btn-outline-secondary dropdown-toggle" data-bs-toggle="dropdown">
                                    <i class="icon-more-vertical"></i>
                                </button>
                                <ul class="dropdown-menu">
                                    <li><a class="dropdown-item" href="#" onclick="duplicateBudget('BDG-2024-004')">
                                        <i class="icon-copy me-2"></i>Duplicate
                                    </a></li>
                                    <li><a class="dropdown-item" href="#" onclick="exportBudget('BDG-2024-004')">
                                        <i class="icon-download me-2"></i>Export
                                    </a></li>
                                    <li><hr class="dropdown-divider"></li>
                                    <li><a class="dropdown-item text-danger" href="#" onclick="budgetManagement.delete('BDG-2024-004')">
                                        <i class="icon-trash me-2"></i>Delete
                                    </a></li>
                                </ul>
                            </div>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Table Pagination -->
    <div class="table-pagination d-flex justify-content-between align-items-center mt-3">
        <div class="pagination-info">
            <span class="text-muted">Showing 1 to 4 of 12 budgets</span>
        </div>
        <nav>
            <ul class="pagination pagination-sm mb-0">
                <li class="page-item disabled">
                    <a class="page-link" href="#" tabindex="-1">Previous</a>
                </li>
                <li class="page-item active">
                    <a class="page-link" href="#">1</a>
                </li>
                <li class="page-item">
                    <a class="page-link" href="#">2</a>
                </li>
                <li class="page-item">
                    <a class="page-link" href="#">3</a>
                </li>
                <li class="page-item">
                    <a class="page-link" href="#">Next</a>
                </li>
            </ul>
        </nav>
    </div>
</div>

<script>
function duplicateBudget(budgetId) {
    console.log('Duplicating budget:', budgetId);
    STMBudget.notifications.show(`Budget ${budgetId} duplicated successfully`, 'success');
}

function exportBudget(budgetId) {
    console.log('Exporting budget:', budgetId);
    STMBudget.notifications.show(`Exporting budget ${budgetId}...`, 'info');
}

// Table row click handler
document.addEventListener('DOMContentLoaded', function() {
    const tableRows = document.querySelectorAll('.budget-row');
    tableRows.forEach(row => {
        row.addEventListener('click', function(e) {
            // Don't trigger if clicking on action buttons
            if (e.target.closest('.action-buttons')) return;
            
            const budgetId = this.dataset.budgetId;
            budgetManagement.details(budgetId);
        });
    });
});
</script>

<style>
.budget-table-wrapper {
    background: white;
    border-radius: 0.5rem;
}

.budget-table {
    margin-bottom: 0;
}

.budget-table th {
    border-top: none;
    font-weight: 600;
    color: #374151;
    font-size: 0.875rem;
    padding: 1rem 0.75rem;
}

.budget-table td {
    padding: 1rem 0.75rem;
    vertical-align: middle;
}

.budget-row {
    cursor: pointer;
    transition: all 0.2s ease;
}

.budget-row:hover {
    background-color: #f8fafc;
}

.budget-id strong {
    color: #111827;
    font-size: 0.9rem;
}

.category-badge {
    font-size: 0.75rem;
    font-weight: 500;
    padding: 0.375rem 0.75rem;
}

.period-info strong {
    color: #111827;
    font-size: 0.9rem;
}

.amount-info strong {
    font-size: 0.95rem;
    font-weight: 600;
}

.status-badge {
    font-size: 0.75rem;
    font-weight: 500;
    padding: 0.375rem 0.75rem;
    display: inline-flex;
    align-items: center;
}

.owner-info {
    display: flex;
    align-items: center;
    gap: 0.75rem;
}

.owner-avatar {
    width: 32px;
    height: 32px;
    background: #3b82f6;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 600;
    font-size: 0.75rem;
    color: white;
    flex-shrink: 0;
}

.owner-details strong {
    font-size: 0.875rem;
    color: #111827;
    display: block;
    line-height: 1.2;
}

.action-buttons {
    display: flex;
    gap: 0.25rem;
    align-items: center;
    justify-content: center;
}

.action-buttons .btn {
    padding: 0.375rem 0.5rem;
    font-size: 0.75rem;
}

.sort-icon {
    font-size: 0.75rem;
    opacity: 0.5;
    transition: opacity 0.2s ease;
}

.table th:hover .sort-icon {
    opacity: 1;
}

.table-pagination {
    padding: 1rem;
    background: #f9fafb;
    border-top: 1px solid #e5e7eb;
}

.pagination-info {
    font-size: 0.875rem;
}

@media (max-width: 768px) {
    .budget-table {
        font-size: 0.8rem;
    }
    
    .budget-table th,
    .budget-table td {
        padding: 0.5rem 0.25rem;
    }
    
    .owner-info {
        flex-direction: column;
        gap: 0.25rem;
        text-align: center;
    }
    
    .owner-avatar {
        width: 24px;
        height: 24px;
        font-size: 0.7rem;
    }
    
    .action-buttons {
        flex-direction: column;
        gap: 0.125rem;
    }
    
    .action-buttons .btn {
        padding: 0.25rem 0.375rem;
        font-size: 0.7rem;
    }
}
</style>
